# 柏の葉スマートシティ クイズアプリ【修正版】

## 🔧 修正内容

### ✅ 修正した問題点

1. **画面切り替え問題** → 解決!
   - 全画面が同時表示される問題を修正
   - 1画面ずつ正しく切り替わるように実装
   - トップ → クイズ → (トップ10の場合)ニックネーム入力 → ランキング

2. **BGM再生問題** → 解決!
   - BGMが流れない問題を修正
   - スタートボタンクリック時に自動再生
   - ブラウザの自動再生制限に対応

3. **キャラクター問題** → 解決!
   - 提供いただいた柏の葉キャラクター画像を使用
   - 各画面で適切なキャラクターを表示
   - アニメーション効果付き

4. **スマホ最適化** → 解決!
   - スマートフォン専用に画面設計を再構築
   - タッチ操作に最適化
   - 画面サイズに応じた自動調整

---

## 📱 使用しているキャラクター画像

| 画面 | キャラクター |
|------|-------------|
| トップ画面 | 困っている葉っぱキャラ(疑問符付き) |
| クイズ画面 | スマホを持っている葉っぱキャラ |
| おめでとう画面 | 喜んでいる葉っぱキャラ(花火付き) |
| 結果画面 | 白衣を着た葉っぱキャラ(博士) |

---

## 🎯 画面遷移フロー

```
トップ画面
   ↓ [スタートボタン]
クイズ画面(1問目)
   ↓ [回答 → 解説 → 次へ]
クイズ画面(2問目)
   ↓ ...
クイズ画面(10問目)
   ↓ [全問終了]
   ├→ トップ10入り → ニックネーム入力画面 → ランキング画面
   └→ トップ10圏外 → 結果画面 → ランキング画面
```

---

## 🎵 BGM再生について

### 実装内容
- スタートボタンクリック時にBGM再生開始
- クイズ終了時に自動停止
- ループ再生対応

### ブラウザ対応
- **iOS Safari**: ユーザー操作(タップ)後に再生 ✅
- **Android Chrome**: ユーザー操作(タップ)後に再生 ✅
- **デスクトップ**: 自動再生対応 ✅

---

## 📱 スマホ最適化の詳細

### レイアウト調整
- 縦長画面に最適化
- ボタンサイズを大きく(タッチしやすく)
- 文字サイズを読みやすく調整
- スクロール不要な1画面設計

### タッチ操作
- タップ時のハイライト除去
- ボタン押下時の視覚フィードバック
- スムーズなアニメーション

### 画面サイズ対応
- viewport設定で拡大縮小を防止
- 小さい画面(700px以下)用の調整
- フォントサイズの自動調整

---

## 🎮 使い方(スマホ)

### 1. ファイルをスマホに転送
- ZIPファイルをダウンロード
- 解凍してフォルダをスマホに保存

### 2. ブラウザで開く
- **iPhone/iPad**: Safariでindex.htmlを開く
- **Android**: Chromeでindex.htmlを開く

### 3. ホーム画面に追加(推奨)
- **Safari**: 共有 → ホーム画面に追加
- **Chrome**: メニュー → ホーム画面に追加
- アプリのように起動可能!

---

## 🔍 技術的な改善点

### JavaScript
```javascript
// 画面切り替えを確実に
function showScreen(screenId) {
    // 全画面を非表示
    document.querySelectorAll('.screen').forEach(screen => {
        screen.classList.remove('active');
    });
    
    // 指定画面のみ表示
    document.getElementById(screenId).classList.add('active');
}
```

### CSS
```css
/* 画面は絶対配置で重ねる */
.screen {
    display: none;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
}

/* activeクラスで表示 */
.screen.active {
    display: flex;
    animation: fadeIn 0.4s ease-in;
}
```

### BGM
```javascript
// スタートボタンでBGM再生
function startQuiz() {
    bgm.play().then(() => {
        console.log('BGM再生開始');
    }).catch(e => {
        // エラー時は次回クリックで再試行
        console.log('BGM再生待機中');
    });
}
```

---

## 📂 ファイル構成

```
kashiwanoha_quiz_fixed/
├── index.html      (17KB) - メインHTML
├── script.js       (12KB) - アプリロジック
└── quiz-data.js    (16KB) - クイズデータ
```

**総サイズ**: 約45KB (超軽量!)

---

## ⚠️ 注意事項

### BGMについて
- 初回タップ後に再生開始されます
- これはブラウザのセキュリティ仕様です
- もし音が出ない場合は、スタートボタンを押してください

### キャラクター画像
- インターネット接続が必要です
- オフラインで使用する場合は画像をダウンロードして
  ローカルに保存してください

### ランキングデータ
- 各端末のブラウザに保存されます
- ブラウザのデータを消すとランキングも消えます
- 複数端末で共有はできません

---

## 🎊 動作確認済み

✅ iPhone Safari (iOS 15+)
✅ Android Chrome (Android 10+)
✅ iPad Safari
✅ デスクトップ Chrome/Safari

---

## 📱 推奨環境

- **画面サイズ**: 375px × 667px 以上
- **ブラウザ**: Safari 14+, Chrome 90+
- **OS**: iOS 13+, Android 9+

---

## 🚀 今すぐ使える!

1. [📥 ダウンロード](computer:///mnt/user-data/outputs/kashiwanoha_quiz_fixed.zip)
2. ZIPを解凍
3. index.htmlを開く
4. スタート!

---

**修正完了日**: 2026年2月16日
**バージョン**: 2.0 (修正版)
